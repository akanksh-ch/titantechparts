{
  "$jsonSchema": {
    "bsonType": "object",
    "required": ["email", "passwordHash", "createdAt"],
    "additionalProperties": false,
    "properties": {
      "_id": {
        "bsonType": "objectId",
        "description": "User identifier"
      },
      "email": {
        "bsonType": "string",
        "pattern": "^\\S+@\\S+\\.\\S+$",
        "description": "Valid email address, required"
      },
      "passwordHash": {
        "bsonType": "string",
        "minLength": 60,
        "maxLength": 100,
        "description": "BCrypt or similar hash, required"
      },
      "username": {
        "bsonType": "string",
        "minLength": 3,
        "maxLength": 32,
        "description": "Unique username"
      },
      "roles": {
        "bsonType": "array",
        "items": {
          "bsonType": "string",
          "enum": ["user", "admin"]
        },
        "description": "User roles"
      },
      "isActive": {
        "bsonType": "bool",
        "description": "Account active flag"
      },
      "createdAt": {
        "bsonType": "date",
        "description": "Creation timestamp, required"
      },
      "updatedAt": {
        "bsonType": "date",
        "description": "Last update timestamp"
      }
    }
  }
}
